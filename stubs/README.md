# micropython-stubs
<img src="docs/colorstubs.jpg"
     alt="pencil stubs"
     width=0%
     height=20%
     style="float: right; margin-right: 10px;" />

This repo stores stubs generated by the [MicroPython-Stubber](https://github.com/Josverl/micropython-stubber) tool.
Currently over a 1.000 stubfiles of common MicroPython modules are stored to aid in code completion, static type checking and overall development using micropython.
[
<!-- ALL-CONTRIBUTORS-BADGE:START - Do not remove or modify this section -->
[![All Contributors](https://img.shields.io/badge/all_contributors-5-orange.svg?style=flat-square)](#contributors-)
<!-- ALL-CONTRIBUTORS-BADGE:END -->

I invite everyone that has generated stubs for a board not on the current list, to submit the stubs via a spull request or by just zipping up your stubs and creating an issue.
Whatever works best for you.

## List of current firmwares and stubs 
The list of the current included firmwares, ports and boards is listed on the [**Firmwares page**](firmwares.md)  

This includes stubs from the following micropython families: 
 - MicroPython
 - Loboris port (ESP32)
 - Pycopy
 - M5Stack
 - EV3 / Lego

## Using the stubs 

In order to use the stubs you need to do a few things:  
 1.  Download a copy of this repo , either via `git clone` or by download a zip file with it's contents
     - store this in a folder, for example 'next to' your software projects such as in `c:\develop\micropython-stubs`  
     this contains a `stubs` folder that contains all stubs

 2. Over time you may want to periodically update this folder using `git pull`

### For each project where you want to use the stubs (Manual configuration) :   
this is not as complex as it seems,

 1.  **Create a symlink folder to `c:\develop\micropython-stubs\stubs` inside your project**  
     This will allow you to reference the same stub files from multiple projects, and limit the space needed. This a recommendation, and things work equally well if you copy the `stubs` folder into your project.  
     For details on how to create a symlink, please see : [_Create a symbolic link_](###create-a-symbolic-link)

 2.  **Copy the [samples](doc/samples) folder to your project**  
 this contains the base files you need to improve syntax highlighting and linting.

 2.  **Select which stub folders you need to reference**  
     - The order will influence results. place the 'higher quality' folders first.
     - Use forward slashes `/` rather than backslashes, also on Windows.
     - for example for micropython 1.13 on an ESP32 select:
         1. "./src/lib",
         2. "all-stubs/cpython_patch",
         3. "all-stubs/mpy_1_13-nightly_frozen/esp32/GENERIC", 
         4. "all-stubs/esp32_1_13_0-103",

 3.  **Configure VSCode to use the selected stub folders**  
      This instructs VSCode to consider your libs folder and the stubs for static code evaluation.
      VSCode allows this configuration to be set on **_workspace_** or _user_ level. I prefer setting it per workspace as that allows different settings for different projects, but you could do either.
     - use the [`.VSCode/settings.json` sample file](docs/samples/.VSCode/settings.json) located in the sample folder
     - you can open this file in VSCode itself, or use the settings menu 
     - place the folders in the 3 sections. 
          - each section should contain the same folders. 
          - it can be on a single line or split across lines. 
          - make sure it is a valid json array 

          ```
          "python.autoComplete.extraPaths": [
               "./src/lib", "all-stubs/cpython_patch", 
               "all-stubs/mpy_1_13-nightly_frozen/esp32/GENERIC", "all-stubs/esp32_1_13_0-103",
          ],
          "python.autoComplete.typeshedPaths": [
               "./src/lib", "all-stubs/cpython_patch", 
               "all-stubs/mpy_1_13-nightly_frozen/esp32/GENERIC", "all-stubs/esp32_1_13_0-103",
          ],
          "python.analysis.typeshedPaths": [
               "./src/lib", "all-stubs/cpython_patch", 
               "all-stubs/mpy_1_13-nightly_frozen/esp32/GENERIC", "all-stubs/esp32_1_13_0-103",
          ]
          ```
 3.  **Configure pylint to use the selected stub folders**  
     This instructs pylint to inster the list of paths into `sys.path` before performing linting, thus alloing it to find the stubs and use them to better validate your code.
     - use the [.pylintcr sample file](docs/sample/.pylintrc) located in the sample folder
     - edit the line that starts with `init-hook=`  
          ``` ini
          init-hook='import sys;sys.path[1:1] = ["src/lib", "folder1","folder2", "folder3",];'
          ```
     - replace the folders with your selection of stub folders. **In this case they MUST be on a single line**
     - the result should look like:
          ``` ini
          init-hook='import sys;sys.path[1:1] = ["src\lib", "all-stubs\cpython_patch","all-stubs\mpy_1_13-nightly_frozen\esp32\GENERIC", "all-stubs\esp32_1_13_0-103",];'
          ```
 4.  **Restart VSCode**  
     VSCode must be restated for the Python language engine and Pylint to read the updated configraton.
     you can use: 
     - the `Developer: Reload Window` command.
     - or stop / start the editor


## Create a symbolic link
To create the symbolic link to the `micropython-stubs/stubs` folder the instructions differ slightly for each OS/
The below examples assume that the micropython-stubs repo is cloned 'next-to' your project folder.
please adjust as needed.

### Windows 10 
Requires `Developer enabled` or elevated powershell prompt.

``` powershell
# target must be an absolute path, resolve path is used to resolve the relative path to absolute
New-Item -ItemType SymbolicLink -Path "all-stubs" -Target (Resolve-Path -Path ../micropython-stubs/stubs)
```
or use [mklink](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/mklink) in an (elevated) command prompt
``` cmd
rem target must be an absolute path
mklink /d all-stubs c:\develop\micropython-stubs\stubs
```

### Linux/Macos/Unix

``` sh
# target must be an absolute path
ln -s /path/to/micropython-stubs/stubs all-stubs
```

## Contributors
Thanks to everyone that has submitted stubs or other relevant pieces of code and information, or published relevant stubs on pypi or github.

<!-- ALL-CONTRIBUTORS-LIST:START - Do not remove or modify this section -->
<!-- prettier-ignore-start -->
<!-- markdownlint-disable -->
<table>
  <tr>
    <td align="center"><a href="https://github.com/Josverl"><img src="https://avatars2.githubusercontent.com/u/981654?v=4?s=100" width="100px;" alt=""/><br /><sub><b>Jos Verlinde</b></sub></a><br /><a href="https://github.com/Josverl/micropython-stubs/commits?author=josverl" title="Code">üíª</a> <a href="#stubs-josverl" title="MicroPython stubs">üìù</a> <a href="#test-josverl" title="Test">‚úî</a> <a href="#tool-josverl" title="Tools">üîß</a></td>
    <td align="center"><a href="https://github.com/BradenM"><img src="https://avatars1.githubusercontent.com/u/5913808?v=4?s=100" width="100px;" alt=""/><br /><sub><b>Braden Mars</b></sub></a><br /><a href="#stubs-BradenM" title="MicroPython stubs">üìù</a> <a href="#test-BradenM" title="Test">‚úî</a> <a href="#tool-BradenM" title="Tools">üîß</a></td>
    <td align="center"><a href="https://github.com/pfalcon"><img src="https://avatars3.githubusercontent.com/u/500451?v=4?s=100" width="100px;" alt=""/><br /><sub><b>Paul Sokolovsky</b></sub></a><br /><a href="#stubs-pfalcon" title="MicroPython stubs">üìù</a></td>
    <td align="center"><a href="https://github.com/dastultz"><img src="https://avatars3.githubusercontent.com/u/4334042?v=4?s=100" width="100px;" alt=""/><br /><sub><b>Daryl Stultz</b></sub></a><br /><a href="#stubs-dastultz" title="MicroPython stubs">üìù</a></td>
    <td align="center"><a href="http://patrickwalters.us/"><img src="https://avatars0.githubusercontent.com/u/4002194?v=4?s=100" width="100px;" alt=""/><br /><sub><b>Patrick</b></sub></a><br /><a href="#test-askpatrickw" title="Test">‚úî</a> <a href="#stubs-askpatrickw" title="MicroPython stubs">üìù</a></td>
  </tr>
</table>

<!-- markdownlint-restore -->
<!-- prettier-ignore-end -->

<!-- ALL-CONTRIBUTORS-LIST:END -->
This project follows the [all-contributors](https://github.com/all-contributors/all-contributors) specification. Contributions of any kind welcome!
